SET B:

1.Retrieve the names of all customers from the `Customers` table, sorted in alphabetical order.

Ans: select cust_name from customer order by cust_name asc;

2. Fetch the top 10 most expensive products from the `Products` table.

Ans: select * from products order by price desc limit 10;

3. Write a query to get the second-highest salary from the `Employees` table.

Ans: select max(salary) from employees
where salary < (select max(salary) from employees);

4. Get the total count of customers from each city in the `Customers` table.

Ans:select city_id, count(cust_name) from Customers
group by city_id;

5. Retrieve department-wise total salary from the `Employees` table but only include
departments where the total salary is greater than 2,00,000.

Ans:select dept_id, sum(salary) from employees
group by dept_id
having sum(salary)>200000;

6. Extract only the last four characters of the `phone_number` column and first three characters
from `customerName` columns from the `Customers` table.

Ans:select substring(phone_number, -4), substring(customerName, 1, 3)
from Customers;

7. Write a query to retrieve products where the `product_name` contains "Pro".

Ans:select product_name from products
where product_name like "%Pro%";

8. Fetch the total number of students per course from the `Students` table, only for courses that
have at least 30 students enrolled.

Ans:select course_id,count(*) as 'total_students' from Students
group by course_id
having count(*)>=30;

9. Write an SQL query to find the number of orders placed in each month of the year.

Ans:select month(order_placed),count(*) as 'total_orders' from Orders
group by month(order_placed);

10. Get the highest and lowest salary per department from the `Employees` table.

Ans:select dept_id, max(salary) as 'Highest_Salary',min(salary) as 'Lowest_Salary' from Employees
group by dept_id;

11. What does the following query return?
SELECT SUBSTRING('Database', 1, 4);
a) Data
b) tabase
c) DataB
d) Error

Ans:a)

12. Which clause is used to sort the results in descending order?
a) ORDER BY DESC
b) ORDER BY ASC
c) SORT BY DESC
d) GROUP BY DESC

Ans:a)

13. What is the default sorting order of `ORDER BY` if no direction (ASC/DESC) is specified?
a) ASC
b) DESC
c) No specific order
d) Error

Ans:a)

14. What will be the output of the following query?
SELECT ROUND(15.678, 2);
a) 15.67
b) 15.68
c) 15.7
d) 16

Ans:b)

15. Which SQL function is used to count the number of rows in a table?
a) TOTAL()
b) COUNT()
c) SUM()
d) NUMBER()

Ans:b)

16. Question:
You have two tables:
• Orders with columns: order_id, customer_id, order_date, total_amount.
• Customers with columns: customer_id, customer_name.
• O/P- customer_id, customer_name, avg_order_value
Write an SQL query to find the average order value (total_amount) for each customer. Only
include customers who have made more than 2 orders.

Ans:select c.customer_id as 'customer_id',c.customer_name as 'customer_name',avg(o.total_amount) as 'avg_order_value' from Orders as o
inner join Customers as c on o.cust_id=c.cust_id group by c.customer_id,c.customer_name
having count(o.order_id)>2;

17. Question:
You have two tables:
• Products with columns: product_id, product_name.
• Sales with columns: sale_id, product_id, sale_date, amount.
• O/P- product_id | product_name | sales_count
Write an SQL query to find the number of sales made for each product. Only include products
with more than 50 sales.

Ans:select p.product_id as 'product_id',p.product_name as 'product_name', count(s.total_sales) as 'sales_count'
from Products as p inner join Sales as s on p.product_id=s.product_id group by p.product_id, p.product_name having count(s.total_sales)>50;